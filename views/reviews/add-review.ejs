<h1 class="h1reviewtitle">
    <%= title %>
</h1>

<%- messages() %>

    <div class="review-container">
        <div class="vehicle-info">
            <img src="<%= invData.inv_thumbnail %>" alt="<%= invData.inv_make %> <%= invData.inv_model %>">
            <h2>
                <%= invData.inv_year %>
                    <%= invData.inv_make %>
                        <%= invData.inv_model %>
            </h2>
        </div>

        <div class="review-form">
            <h3>Write Your Review</h3>
            <form action="/review/add" method="post">

                <!-- Star rating -->
                <div class="form-group-rating-group">
                    <label>RATING</label>
                    <div class="star-rating">
                        <input type="radio" id="star5" name="review_rating" value="5" <%=review_rating==5 ? 'checked'
                            : '' %> required>
                        <label for="star5" title="5 stars">★</label>

                        <input type="radio" id="star4" name="review_rating" value="4" <%=review_rating==4 ? 'checked'
                            : '' %>>
                        <label for="star4" title="4 stars">★</label>

                        <input type="radio" id="star3" name="review_rating" value="3" <%=review_rating==3 ? 'checked'
                            : '' %>>
                        <label for="star3" title="3 stars">★</label>

                        <input type="radio" id="star2" name="review_rating" value="2" <%=review_rating==2 ? 'checked'
                            : '' %>>
                        <label for="star2" title="2 stars">★</label>

                        <input type="radio" id="star1" name="review_rating" value="1" <%=review_rating==1 ? 'checked'
                            : '' %>>
                        <label for="star1" title="1 star">★</label>
                    </div>
                </div>

                <!-- Review text -->
                <div class="form-group">
                    <label for="review_text">Your review * (minimum 10 characters)</label>
                    <textarea id="review_text" name="review_text" rows="6" maxlength="1000"
                        placeholder="Share your experience with this vehicle..."
                        required><%= review_text || '' %></textarea>
                    <small class="char-count"><span id="charCount">0</span>/1000 characters</small>
                </div>

                <!-- Hidden field for inv_id -->
                <input type="hidden" name="inv_id" value="<%= invData.inv_id %>">

                <!-- Buttons -->
                <div class="form-buttons">
                    <button type="submit" class="btn-primary">Publish Review</button>
                    <a href="/inv/detail/<%= invData.inv_id %>" class="btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Character counter
        document.addEventListener('DOMContentLoaded', function () {
            const textarea = document.getElementById('review_text');
            const charCount = document.getElementById('charCount');

            function updateCount() {
                charCount.textContent = textarea.value.length;
            }

            textarea.addEventListener('input', updateCount);
            updateCount();
        });
    </script>